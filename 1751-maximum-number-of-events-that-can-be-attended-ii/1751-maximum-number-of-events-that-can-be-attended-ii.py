from bisect import bisect
class Solution:
    def maxValue(self, A: List[List[int]], k: int) -> int:
        A.sort(key = lambda x: x[1])
        dp, dp2 = [[0, 0]], [[0, 0]]
        #dp: last ending time, the max values so far for the last ending time
        for _ in range(k):
            for s, e, v in A:
                idx = bisect(dp, [s]) - 1
                #because the events were sorted by ending time, the idx can not exceed the current index
                if dp[idx][1] + v > dp2[-1][1]:
                    dp2.append([e, dp[idx][1] + v])
                    #the new value is higher than the previous highest value, so dp is a strictly increasing list
            dp, dp2 = dp2, [[0, 0]]
        
        return dp[-1][1]
        
            
            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        